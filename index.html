<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>MP3 Uploader</title>
  <style>
    body {
      background: linear-gradient(135deg, #0f0f0f, #1a1a1a);
      font-family: 'Segoe UI', sans-serif;
      color: #facc15;
      padding: 50px;
      text-align: center;
      overflow: hidden;
    }

    #drop-area {
      border: 3px dashed #facc15;
      padding: 40px;
      border-radius: 20px;
      width: 90%;
      max-width: 600px;
      margin: 0 auto;
      cursor: pointer;
    }

    .progress-bar {
      margin-top: 20px;
      background: #2a2a2a;
      height: 30px;
      border-radius: 15px;
      overflow: hidden;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }

    .progress-fill {
      height: 100%;
      width: 0%;
      background: linear-gradient(to right, #facc15, #fcd34d);
      color: black;
      text-align: center;
      line-height: 30px;
      font-weight: bold;
      transition: width 0.3s;
    }

    .meteor {
      position: absolute;
      width: 2px;
      height: 80px;
      background: linear-gradient(to bottom, #facc15, transparent);
      animation: fall linear infinite;
    }

    @keyframes fall {
      0% { transform: translateY(-100px); opacity: 1; }
      100% { transform: translateY(100vh) translateX(100vw); opacity: 0; }
    }

    @media(max-width: 600px) {
      body { padding: 20px; }
    }
  </style>
</head>
<body>
  <h1>Upload MP3 Files</h1>
  <div id="drop-area">Drop MP3 files here or click to select</div>

  <div class="progress-bar">
    <div class="progress-fill" id="progress">0%</div>
  </div>

  <div id="status"></div>

  <!-- Meteor background -->
  <script>
    for (let i = 0; i < 30; i++) {
      const m = document.createElement('div');
      m.className = 'meteor';
      m.style.left = Math.random() * 100 + 'vw';
      m.style.animationDuration = (Math.random() * 2 + 1) + 's';
      m.style.animationDelay = Math.random() * 10 + 's';
      document.body.appendChild(m);
    }
  </script>

  <!-- Upload Script -->
  <script>
    const cloudName = "dzs0mwqpm";
    const uploadPreset = "uploads";

    const dropArea = document.getElementById('drop-area');
    const progress = document.getElementById('progress');
    const status = document.getElementById('status');

    dropArea.addEventListener('click', () => {
      const input = document.createElement('input');
      input.type = 'file';
      input.accept = '.mp3';
      input.multiple = true;
      input.onchange = () => handleFiles(input.files);
      input.click();
    });

    dropArea.addEventListener('dragover', e => e.preventDefault());
    dropArea.addEventListener('drop', e => {
      e.preventDefault();
      handleFiles(e.dataTransfer.files);
    });

    function handleFiles(files) {
      const mp3s = [...files].filter(f => f.type === "audio/mpeg");
      if (mp3s.length === 0) return alert("Only MP3 files allowed!");

      status.innerText = '';
      let uploaded = 0;

      mp3s.forEach((file, index) => {
        const url = `https://api.cloudinary.com/v1_1/${cloudName}/video/upload`;
        const formData = new FormData();
        formData.append("file", file);
        formData.append("upload_preset", uploadPreset);

        const xhr = new XMLHttpRequest();
        xhr.open("POST", url);

        xhr.upload.addEventListener("progress", e => {
          if (e.lengthComputable) {
            const percent = Math.round(((uploaded + e.loaded / e.total) / mp3s.length) * 100);
            progress.style.width = percent + "%";
            progress.innerText = `${index + 1}/${mp3s.length}`;
          }
        });

        xhr.onload = () => {
          uploaded++;
          if (uploaded === mp3s.length) {
            progress.style.width = "100%";
            progress.innerText = "Completed";
            status.innerText = "All MP3 files uploaded successfully!";
          }
        };

        xhr.send(formData);
      });
    }
  </script>
</body>
</html>
